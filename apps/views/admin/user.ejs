<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Người dùng</title>
    <%- include("layout/head.ejs") %>
    <link rel="stylesheet" href="/static/css/responsive-table.css">
</head>
<body>
    <div class="container">
    <%- include("layout/nav.ejs") %>
    <div class="row" style="margin-bottom:10px; ">
        <div class="col-md-12">
            <a href="/admin/signup" class="btn btn-success pull-right">Thêm người dùng</a>
        </div>
    </div>

        <div class="panel panel-default">
            <div class="panel-heading">
                <b>Danh sách </b><% if (data && data.countpermiss){ %>(Quản trị: <b><%= data.countpermiss.admin %></b>, Quản lý: <b><%= data.countpermiss.user %></b>, Thành viên: <b><%= data.countpermiss.guest %></b>)<%}%>
            </div>
                      
            <div class="panel-body"  style="overflow: auto;">
                <% if (data && data.error){ %>
                    <div id="login-alert" class="alert alert-danger col-sm-12" style="text-align:center">
                        <%= data.error %>
                    </div>
                <%}%>
                    <div>
                        <table class="table table-striped table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th>STT</th>
                                    <th>Tên đăng nhập</th>
                                    <th>Phân quyền</th>
                                    <th>Tên hiển thị</th>
                                    <th>Thời gian</th>
                                    <th>Tương tác</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% if (data && data.users){%>
                                    <% for (var i= 0; i < data.users.length; i++) { %>
                                    <tr>
                                        <td data-label="STT"><%= i+1 %> </td> 
                                        <td data-label="Tên đăng nhập"><%= data.users[i].email %> </td> 
                                        <td data-label="Phân quyền"><%= data.users[i].trackper %> </td> 
                                        <td data-label="Tên hiển thị"><%= data.users[i].last_name %> </td> 
                                        <td data-label="Thời gian">
                                            <p><b>Khởi tạo: </b><%= data.users[i].created_at %></p>
                                            <p><b>Cập nhật: </b><%= data.users[i].updated_at %></p>
                                        </td> 
                                        <% if (data && data.user.id == data.users[i].id){ %>
                                        <td data-label="Tương tác"></td>
                                        <% }else{ %> 
                                        <td data-label="Tương tác">
                                            <button href="/admin/delete" class="btn btn-danger user_delete" user_id="<%= data.users[i].id %>">Xóa</button>
                                        </td>
                                        <% } %>

                                    </tr>
                                    <% } %>
                                <% } %>  

                            </tbody>
                        </table>
                    </div>
            </div>
        </div>
    </div> 
    <script type="text/javascript" src="/static/js/user.js"></script>
</body>
</html>