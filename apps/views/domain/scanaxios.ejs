<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quét Tên miền</title>
    <%- include("../admin/layout/head.ejs") %>
    <link rel="stylesheet" href="/static/css/responsive-table.css">
</head>
<body>
    <div class="container">
    <%- include("../admin/layout/nav.ejs") %>

        <div class="row" style="margin-bottom:10px; ">
            <div style="padding-top:15px;display: flex; " class="panel-body text-center">
                    <input type="hidden" name="username" id="username" value="<%- data.user.last_name %>">
                    <input type="hidden" name="id_user" id="id_user" value="<%- data.user.id %>">
                    <input id="textdomain" type="text" class="form-control col-9 col-sm-9 col-md-9 col-lg-9" style="margin-right: 5px;" name="textdomain" placeholder="Từ khóa trong Tên miền (Tối đa 50 ký tự)" maxlength="50" />
                    <button id="btn-add-key" class="btn btn-info col-3 col-sm-3 col-md-3 col-lg-3">Thêm mới</button>
            </div> 
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">
                Danh sách từ khóa trong Tên miền
            </div>
            <div class="panel-body" style="overflow: auto;">
                <% if (data && data.error){ %>
                    <div id="login-alert" class="alert alert-danger col-sm-12" style="text-align:center">
                        <%= data.error %>
                    </div>
                <%}%>
                    <div>
                        <table class="table table-striped table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th>STT</th>
                                    <th>Từ khóa</th>
                                    <!-- <th>List Index</th> -->
                                    <th>Danh sách Tên miền</th>
                                    <th>Đã quét</th>
                                    <!-- <th>Created Time</th> -->
                                    <th>Tương tác</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% if (data && data.data && data.data.length>0){%>
                                    <% for (var i= data.data.length-1; i > -1; i--) { %>
                                    <tr>
                                        <td data-label="STT"><%= data.data.length-i %> </td> 
                                        <td data-label="Từ khóa"><%= data.data[i].keyval %> </td>
                                        <!-- <td data-label="List Index">< %= data.data[i].arr %> </td> -->
                                        <td data-label="Danh sách Tên miền"  style = "overflow: auto; max-height: 300px;">
                                            <ul style="max-height: 300px;text-align: left; max-width: 800px; padding: 0; list-style: none;">
                                             <% if (data.data[i].data && data.data[i].data.length>0&&data.data[i].data.indexOf("[")>=0) { %>
                                                <%for (let w=0;w<JSON.parse(data.data[i].data).length;w++){%>
                                                    <li><b><%= w+1 %>-</b><a href="<%= JSON.parse(data.data[i].data)[w] %>" target="_blank"><%= JSON.parse(data.data[i].data)[w] %></a></li>
                                                <%}%>
                                                        <!-- < %for (let w=0;w<data.data[i].data.split('["')[1].split('"]')[0].split('","').length;w++){%>
                                                            <li> < %= w+1 %>-<a href="< %= data.data[i].data.split('["')[1].split('"]')[0].split('","')[w] %>" target="_blank">< %= data.data[i].data.split('["')[1].split('"]')[0].split('","')[w] %></a></li>
                                                        < %}%> -->
                                            <%} else {%>
                                                <li>Không có</li>
                                            <%}%>
                                            </ul> 
                                        </td> 
                                        <td data-label="Đã quét"><%= data.data[i].numcheck %> </td> 
                                        <!-- <td data-label="Created Time">< %= data.data[i].created_at %> </td>  -->
                                        <td data-label="Tương tác">
                                            <p><b>Thời gian: </b><%= data.data[i].created_at %></p>
                                            <button href="/scandomain/edit" class="btn btn-info post_onof" id="<%= data.data[i].keyval %>" type="button" value="<% if (data.data[i].run==2){%>off<%} else {%>on<%}%>"><% if (data.data[i].run==2){%>Tắt<%} else {%>Mở<%}%></button>
                                            <button href="/scandomain/delete" class="btn btn-danger post_delete" domain_id="<%= data.data[i].keyval %>">Xóa</button>
                                        </td>
                                    </tr>
                                    <% } %>
                                <% } %>  

                            </tbody>
                        </table>
                    </div>
            </div>
        </div>
    </div> 
    <script type="text/javascript" src="/static/js/scandomain.js"></script>

</body>
</html>